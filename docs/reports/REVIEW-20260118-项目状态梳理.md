# LLM Math Calculator 项目状态梳理报告

## 基本信息

| 项目 | 内容 |
|------|------|
| 报告日期 | 2026-01-18 |
| 项目名称 | LLM Math Calculator (LMC) |
| 项目定位 | AI 基础设施领域的资源规划辅助工具 |
| 当前阶段 | 设计阶段（Design Phase） |

## 一、项目现状总览

### 1.1 文件清单

| 文件/文件夹 | 状态 | 说明 |
|-------------|------|------|
| `README.md` | 已完成 | 完整的技术设计规格（中文） |
| `CLAUDE.md` | 已完成 | Claude Code 项目指南 |
| `docs/` | 已创建 | 文档结构已建立 |
| `data/` | 已创建 | 空文件夹，待填充 |
| `release/` | 已创建 | 空文件夹，待发布产物 |
| 源代码 | **未实现** | 无任何代码文件 |

### 1.2 实现进度

| 模块 | 设计状态 | 实现状态 | 优先级 |
|------|----------|----------|--------|
| 硬件数据库 (hardware.json) | ✅ 已设计 | ❌ 未实现 | P0 |
| 模型预设库 (presets.json) | ✅ 已设计 | ❌ 未实现 | P0 |
| 计算引擎 (Calc Engine) | ✅ 已设计 | ❌ 未实现 | P0 |
| 策略推荐器 (Optimizer) | ✅ 已设计 | ❌ 未实现 | P1 |
| CLI 工具 | ✅ 已设计 | ❌ 未实现 | P1 |
| Python Library | ✅ 已设计 | ❌ 未实现 | P1 |
| Web UI | ✅ 已设计 | ❌ 未实现 | P2 |

## 二、设计规格摘要

### 2.1 核心公式（已定义）

1. **训练算力计算**
   - 公式：`Total FLOPs = 6 * P * D`
   - P = 模型参数量，D = 训练数据量（Tokens）
   - 需支持 MoE、SwiGLU 等结构的修正系数

2. **显存占用计算（ZeRO-0 基准）**
   - 参数 (FP16): `2 Bytes * P`
   - 梯度 (FP16): `2 Bytes * P`
   - 优化器状态 (Adam, FP32): `12 Bytes * P`
   - 总计: `16 Bytes * P`

3. **激活值估算**
   - 公式：`s * b * h * L * (34 + 5 * a * s / h)`
   - 依赖：seq_len, batch_size, hidden_size, layers

4. **KV Cache（推理场景）**
   - 公式：`2 * b * s * h * L * 2 Bytes`

5. **训练时间估算**
   - 公式：`Time = Total FLOPs / (Num_GPUs * Peak_FLOPs * MFU)`

### 2.2 硬件数据库（已定义结构）

```json
{
  "A100-80G-SXM": {
    "memory_GB": 80,
    "fp16_tflops": 312,
    "bf16_tflops": 312,
    "bandwidth_GBs": 2039,
    "intra_connect": "NVLink",
    "vendor": "NVIDIA"
  }
}
```

### 2.3 CLI 交互设计（已定义）

- 交互式模式：`lmc train`
- 参数直通模式：`lmc train --gpu A800 --params 70B --tokens 400B --days 30`

## 三、冗余/过期/无效内容检查

### 3.1 检查结果

| 检查项 | 结果 |
|--------|------|
| 冗余代码 | 无（项目无代码） |
| 过期配置 | 无 |
| 无效测试 | 无（项目无测试） |
| 重复文档 | 无 |
| 错误逻辑 | 无 |

### 3.2 说明

当前项目处于初始设计阶段，仅包含设计文档，无实际代码或配置文件，因此不存在冗余、过期或无效内容。

## 四、待办事项清单

### 4.1 基础设施（P0）

- [ ] 确定技术栈（Python 版本、依赖管理工具）
- [ ] 初始化项目结构（src、tests、configs）
- [ ] 配置开发环境（pyproject.toml / setup.py）
- [ ] 创建 hardware.json 硬件数据库
- [ ] 创建 presets.json 模型预设库

### 4.2 核心功能（P0）

- [ ] 实现计算引擎核心公式
- [ ] 实现显存估算模块
- [ ] 实现训练时间估算模块
- [ ] 实现 KV Cache 估算模块

### 4.3 用户接口（P1）

- [ ] 实现 CLI 工具框架（推荐：click 或 typer）
- [ ] 实现交互式问答模式
- [ ] 实现参数直通模式
- [ ] 实现报告输出格式化

### 4.4 策略推荐（P1）

- [ ] 实现 TP/PP/DP 并行策略推荐
- [ ] 实现 ZeRO 阶段推荐
- [ ] 实现网络瓶颈检测

### 4.5 扩展功能（P2）

- [ ] Web UI 开发
- [ ] Python Library 封装
- [ ] 文档和示例

## 五、建议的下一步行动

1. **创建 IMPLEMENTATION_PLAN.md**：制定详细的实现计划
2. **初始化 Python 项目**：建立基本的项目骨架
3. **实现数据层**：先完成 hardware.json 和 presets.json
4. **实现核心计算**：优先完成计算引擎的核心公式

## 六、风险与注意事项

1. **MoE 模型支持**：需区分 total_params 和 active_params
2. **MFU 取值**：不同硬件的 MFU 经验值差异较大，需提供合理默认值
3. **国产化支持**：昇腾等国产芯片的参数需要验证

---

*报告生成时间：2026-01-18*
